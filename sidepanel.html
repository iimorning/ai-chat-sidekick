<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="container">
    <!-- ============================================= -->
    <!--   这是新的、用于 Google 登录的认证容器         -->
    <!-- ============================================= -->
    <div id="authContainer">
      <h1>欢迎使用 AI Sidekick</h1>
      <p>请使用您的 Google 账户安全登录。</p>
      
      <!-- 修改：用一个简单的“使用 Google 登录”按钮替换掉邮件表单 -->
      <button id="loginButton" class="login-btn-google">
        <svg aria-hidden="true" width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px;"><path d="M16.51 8.25H9v3.03h4.33c-.18 1.02-.74 1.88-1.57 2.44v2.04h2.63c1.54-1.42 2.42-3.48 2.42-5.91 0-.54-.05-.98-.14-1.4z" fill="#4285F4"></path><path d="M9 18c2.43 0 4.47-.8 5.96-2.18l-2.63-2.04c-.8.54-1.84.86-3.33.86-2.54 0-4.68-1.72-5.45-4.02H1.03v2.1C2.5 16.25 5.51 18 9 18z" fill="#34A853"></path><path d="M3.55 10.97c-.18-.54-.28-1.12-.28-1.72s.1-1.18.28-1.72V5.42H1.03C.37 6.64 0 8.27 0 10.02s.37 3.38 1.03 4.6V10.97z" fill="#FBBC05"></path><path d="M9 3.58c1.32 0 2.5.45 3.44 1.34l2.33-2.33C13.46.86 11.43 0 9 0 5.51 0 2.5 1.77 1.03 4.6l2.52 2.1c.77-2.3 2.91-4.02 5.45-4.02z" fill="#EA4335"></path></svg>
        使用 Google 登录
      </button>
      
      <p id="authMessage" style="margin-top: 10px; font-size: 14px;"></p>
    </div>

    <!-- ============================================= -->
    <!--  这个是登录后显示的主内容区，内容保持不变      -->
    <!-- ============================================= -->
    <main id="mainContent" style="display: none;">
      <!-- 用户状态和登出按钮 -->
      <div class="user-status" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <span id="userEmail" style="font-size: 12px; color: #555;"></span>
        <button id="logoutButton" style="padding: 4px 8px; font-size: 12px; background-color: #6c757d;">登出</button>
      </div>

    <main>
      <section class="user-input-section">
        <h3>当前输入：</h3>
        <p id="currentUserInput">正在等待用户输入...</p>
      </section>

      <!-- 智能操作按钮 -->
     <!-- 新的、主次分明的操作按钮布局 -->
<section class="actions-section">
  <div class="actions-container">
    <!-- 主按钮，用于优化输入 -->
    <button id="optimizeBtn" class="btn btn-primary" title="优化并分析输入">优化输入</button>
    <!-- 次要按钮，保留结构化功能 -->
    <button id="structureBtn" class="btn btn-secondary" title="添加结构化参数">结构化</button>
  </div>
</section>
      <section class="result-section">
        <div class="result-header">
          <h3>生成结果：</h3>
          <div class="header-actions"> <!-- 1. 新增一个容器包裹右侧的按钮 -->
            <button id="copyResultBtn" class="icon-btn" title="复制结果">
              <span class="icon-copy">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
              </span>
              <span class="icon-success">✅</span>
            </button>
            <!-- 2. 新增历史记录图标按钮 -->
            <button id="historyToggleBtn" title="查看历史记录">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            </button>
          </div>
        </div>
        <div class="result-wrapper"> 
          <div id="resultOutput" class="result-box">...</div>
        </div>
      </section>
      <main>
        <!-- ================================== -->
        <!--      新增：历史记录区域 (v1.5)      -->
        <!-- ================================== -->
         <!-- 3. 将 history-section 改造成一个默认隐藏的下拉菜单 -->
         <section id="historyDropdown" class="history-section dropdown-menu">
          <div class="history-header">
            <h3>历史记录</h3>
            <button id="clearHistoryBtn" title="清空所有历史记录">清空</button>
          </div>
          <div id="historyList" class="history-list">...</div>
        </section>
  
    </main>
  </div>
      <script src="supabase.js"></script>
      <script src="sidepanel.js"></script>
</body>
</html>